<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dylan Scott" />


<title>Casestudy2DDS</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Backstory</a>
</li>
<li>
  <a href="Beer_Case_Study_1_Final.html">Beer Case Study</a>
</li>
<li>
  <a href="CaseStudy2DDS.html">CaseStudy2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Casestudy2DDS</h1>
<h4 class="author">Dylan Scott</h4>
<h4 class="date">4/6/2021</h4>

</div>


<div id="youtube-link" class="section level2">
<h2>Youtube link</h2>
<p><a href="https://youtu.be/Yy1s2UjK_Ww"> Dylan’s Case study 2 Video </a></p>
</div>
<div id="project-overview" class="section level2">
<h2>Project Overview</h2>
</div>
<div id="data-breakdown" class="section level2">
<h2>Data Breakdown</h2>
<p>870 observation with 36 variables</p>
<pre class="r"><code>library(knitr)
library(tidyverse)
library(readxl)
library(curl)
library(GGally)
library(e1071)
library(caret)
library(ggcorrplot)
library(gridExtra)
library(reticulate)
library(gt)


data &lt;-read.csv(curl(&quot;https://raw.githubusercontent.com/Scottdyl/CaseStudy2DDS/main/data/CaseStudy2-data.csv&quot;))

#summary(data)
#no missing values found

#convert raw data variables to factors
data$Education = as.factor(data$Education)
data$EnvironmentSatisfaction = as.factor(data$EnvironmentSatisfaction)
data$JobInvolvement = as.factor(data$JobInvolvement)
data$JobLevel = as.factor(data$JobLevel)
data$JobSatisfaction = as.factor(data$JobSatisfaction)
data$PerformanceRating = as.factor(data$PerformanceRating)
data$RelationshipSatisfaction = as.factor(data$RelationshipSatisfaction)
data$WorkLifeBalance = as.factor(data$WorkLifeBalance)


# no attr data
Comp_attr &lt;- read.csv(curl(&quot;https://raw.githubusercontent.com/Scottdyl/CaseStudy2DDS/main/data/CaseStudy2CompSet%20No%20Attrition.csv&quot;))
Comp_attr$Education = as.factor(Comp_attr$Education)
Comp_attr$EnvironmentSatisfaction = as.factor(Comp_attr$EnvironmentSatisfaction)
Comp_attr$JobInvolvement = as.factor(Comp_attr$JobInvolvement)
Comp_attr$JobLevel = as.factor(Comp_attr$JobLevel)
Comp_attr$JobSatisfaction = as.factor(Comp_attr$JobSatisfaction)
Comp_attr$PerformanceRating = as.factor(Comp_attr$PerformanceRating)
Comp_attr$RelationshipSatisfaction = as.factor(Comp_attr$RelationshipSatisfaction)
Comp_attr$WorkLifeBalance = as.factor(Comp_attr$WorkLifeBalance)


# no sal data
Comp_sal &lt;-read.csv(curl(&quot;https://raw.githubusercontent.com/Scottdyl/CaseStudy2DDS/main/data/CaseStudy2CompSet%20No%20Salary.csv&quot;))
Comp_sal$Education = as.factor(Comp_sal$Education)
Comp_sal$EnvironmentSatisfaction = as.factor(Comp_sal$EnvironmentSatisfaction)
Comp_sal$JobInvolvement = as.factor(Comp_sal$JobInvolvement)
Comp_sal$JobLevel = as.factor(Comp_sal$JobLevel)
Comp_sal$JobSatisfaction = as.factor(Comp_sal$JobSatisfaction)
Comp_sal$PerformanceRating = as.factor(Comp_sal$PerformanceRating)
Comp_sal$RelationshipSatisfaction = as.factor(Comp_sal$RelationshipSatisfaction)
Comp_sal$WorkLifeBalance = as.factor(Comp_sal$WorkLifeBalance)

head(data)</code></pre>
<pre><code>##   ID Age Attrition    BusinessTravel DailyRate             Department DistanceFromHome Education   EducationField
## 1  1  32        No     Travel_Rarely       117                  Sales               13         4    Life Sciences
## 2  2  40        No     Travel_Rarely      1308 Research &amp; Development               14         3          Medical
## 3  3  35        No Travel_Frequently       200 Research &amp; Development               18         2    Life Sciences
## 4  4  32        No     Travel_Rarely       801                  Sales                1         4        Marketing
## 5  5  24        No Travel_Frequently       567 Research &amp; Development                2         1 Technical Degree
## 6  6  27        No Travel_Frequently       294 Research &amp; Development               10         2    Life Sciences
##   EmployeeCount EmployeeNumber EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1             1            859                       2   Male         73              3        2
## 2             1           1128                       3   Male         44              2        5
## 3             1           1412                       3   Male         60              3        3
## 4             1           2016                       3 Female         48              3        3
## 5             1           1646                       1 Female         32              3        1
## 6             1            733                       4   Male         32              3        3
##                  JobRole JobSatisfaction MaritalStatus MonthlyIncome MonthlyRate NumCompaniesWorked Over18 OverTime
## 1        Sales Executive               4      Divorced          4403        9250                  2      Y       No
## 2      Research Director               3        Single         19626       17544                  1      Y       No
## 3 Manufacturing Director               4        Single          9362       19944                  2      Y       No
## 4        Sales Executive               4       Married         10422       24032                  1      Y       No
## 5     Research Scientist               4        Single          3760       17218                  1      Y      Yes
## 6 Manufacturing Director               1      Divorced          8793        4809                  1      Y       No
##   PercentSalaryHike PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel TotalWorkingYears
## 1                11                 3                        3            80                1                 8
## 2                14                 3                        1            80                0                21
## 3                11                 3                        3            80                0                10
## 4                19                 3                        3            80                2                14
## 5                13                 3                        3            80                0                 6
## 6                21                 4                        3            80                2                 9
##   TrainingTimesLastYear WorkLifeBalance YearsAtCompany YearsInCurrentRole YearsSinceLastPromotion
## 1                     3               2              5                  2                       0
## 2                     2               4             20                  7                       4
## 3                     2               3              2                  2                       2
## 4                     3               3             14                 10                       5
## 5                     2               3              6                  3                       1
## 6                     4               2              9                  7                       1
##   YearsWithCurrManager
## 1                    3
## 2                    9
## 3                    2
## 4                    7
## 5                    3
## 6                    7</code></pre>
</div>
<div id="exploring-all-continious-varables." class="section level2">
<h2>exploring all continious varables.</h2>
</div>
<div id="plotting-and-looking-at-all-continious-varbles.-the-most-significant-will-be-shown-in-the-next-chunk." class="section level2">
<h2>Plotting and looking at all continious varbles. The most significant will be shown in the next chunk.</h2>
<pre class="r"><code>#commented out least impactful looking varables
#data %&gt;% ggplot(aes(Age))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(YearsSinceLastPromotion))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(TrainingTimesLastYear))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(StockOptionLevel))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(PercentSalaryHike))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(NumCompaniesWorked))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(MonthlyRate))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(HourlyRate))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(DailyRate))+geom_density(aes(fill=Attrition))
#data %&gt;% ggplot(aes(DistanceFromHome))+geom_density(aes(fill=Attrition))</code></pre>
<pre class="r"><code>#summary(as.matrix(data))
corr_data_y &lt;- data %&gt;% filter(Attrition ==&quot;Yes&quot;) %&gt;% select(Age, TotalWorkingYears, YearsAtCompany, YearsSinceLastPromotion, YearsInCurrentRole, YearsWithCurrManager, MonthlyIncome,TrainingTimesLastYear,StockOptionLevel,PercentSalaryHike,NumCompaniesWorked,DistanceFromHome)

corr &lt;- round(cor(corr_data_y),1)

ggcorrplot(corr, hc.order = TRUE, 
           type = &quot;lower&quot;, 
           lab = TRUE, 
           lab_size = 3, 
           method=&quot;circle&quot;, 
           colors = c(&quot;red&quot;, &quot;white&quot;, &quot;springgreen3&quot;), 
           title=&quot;Continuous Variables with Attrition&quot;, 
           ggtheme=theme_bw)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>corr_data_n &lt;- data %&gt;% filter(Attrition ==&quot;No&quot;) %&gt;% select(Age, TotalWorkingYears, YearsAtCompany, YearsSinceLastPromotion, YearsInCurrentRole, YearsWithCurrManager, MonthlyIncome,TrainingTimesLastYear,StockOptionLevel,PercentSalaryHike,NumCompaniesWorked,DistanceFromHome)

corr &lt;- round(cor(corr_data_n),1)

ggcorrplot(corr, hc.order = TRUE, 
           type = &quot;lower&quot;, 
           lab = TRUE, 
           lab_size = 3, 
           method=&quot;circle&quot;, 
           colors = c(&quot;red&quot;, &quot;white&quot;, &quot;springgreen3&quot;), 
           title=&quot;Continuous Variables without Attrition&quot;, 
           ggtheme=theme_bw)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-2-2.png" width="672" /> ## TTest - testing the 5 most significant varables</p>
<pre class="r"><code># we will be using a T test here because we would like to know: does this variable lead to a difference in attrition?
# if we have a samll P value that means this varable does show a difference in means betwwen attrition and not.

att_mi &lt;- data %&gt;% filter(Attrition==&quot;Yes&quot;) %&gt;% select(MonthlyIncome)
stay_mi &lt;- data %&gt;% filter(Attrition==&quot;No&quot;) %&gt;% select(MonthlyIncome)
mi_t &lt;-t.test(att_mi, stay_mi, alternative=&quot;two.sided&quot;)

att_twy &lt;- data %&gt;% filter(Attrition==&quot;Yes&quot;) %&gt;% select(TotalWorkingYears)
stay_twy &lt;- data %&gt;% filter(Attrition==&quot;No&quot;) %&gt;% select(TotalWorkingYears)
twy_t &lt;-t.test(att_twy, stay_twy, alternative=&quot;two.sided&quot;)

att_yicr &lt;- data %&gt;% filter(Attrition==&quot;Yes&quot;) %&gt;% select(YearsInCurrentRole)
stay_yicr &lt;- data %&gt;% filter(Attrition==&quot;No&quot;) %&gt;% select(YearsInCurrentRole)
yicr &lt;- t.test(att_yicr, stay_yicr, alternative=&quot;two.sided&quot;)

att_ywcm &lt;- data %&gt;% filter(Attrition==&quot;Yes&quot;) %&gt;% select(YearsWithCurrManager)
stay_ywcm &lt;- data %&gt;% filter(Attrition==&quot;No&quot;) %&gt;% select(YearsWithCurrManager)
ywcm &lt;- t.test(att_ywcm, stay_ywcm, alternative=&quot;two.sided&quot;)

att_yac &lt;- data %&gt;% filter(Attrition==&quot;Yes&quot;) %&gt;% select(YearsAtCompany)
stay_yac &lt;- data %&gt;% filter(Attrition==&quot;No&quot;) %&gt;% select(YearsAtCompany)
yac &lt;- t.test(att_yac, stay_yac, alternative=&quot;two.sided&quot;)

cont_var = c(&quot;MonthlyIncome&quot;, &quot;TotalWorkingYears&quot;,&quot;YearsInCurrentRole&quot;,&quot;YearsWithCurrManager&quot;,&quot;YearsAtCompany&quot;)
ttest_p = c(mi_t$p.value, twy_t$p.value, yicr$p.value, ywcm$p.value, yac$p.value)

df1_ttest = data.frame(Variable=cont_var, &quot;T-Test pvalue&quot;=ttest_p)
gt(df1_ttest)</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rbqsmizbeu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rbqsmizbeu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbqsmizbeu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rbqsmizbeu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rbqsmizbeu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbqsmizbeu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbqsmizbeu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rbqsmizbeu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rbqsmizbeu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rbqsmizbeu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rbqsmizbeu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rbqsmizbeu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rbqsmizbeu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rbqsmizbeu .gt_from_md > :first-child {
  margin-top: 0;
}

#rbqsmizbeu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rbqsmizbeu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rbqsmizbeu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#rbqsmizbeu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbqsmizbeu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#rbqsmizbeu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbqsmizbeu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rbqsmizbeu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rbqsmizbeu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbqsmizbeu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbqsmizbeu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#rbqsmizbeu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbqsmizbeu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#rbqsmizbeu .gt_left {
  text-align: left;
}

#rbqsmizbeu .gt_center {
  text-align: center;
}

#rbqsmizbeu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rbqsmizbeu .gt_font_normal {
  font-weight: normal;
}

#rbqsmizbeu .gt_font_bold {
  font-weight: bold;
}

#rbqsmizbeu .gt_font_italic {
  font-style: italic;
}

#rbqsmizbeu .gt_super {
  font-size: 65%;
}

#rbqsmizbeu .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="rbqsmizbeu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">T.Test.pvalue</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">MonthlyIncome</td>
      <td class="gt_row gt_right">2.412488e-07</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">TotalWorkingYears</td>
      <td class="gt_row gt_right">6.595682e-07</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">YearsInCurrentRole</td>
      <td class="gt_row gt_right">1.522152e-06</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">YearsWithCurrManager</td>
      <td class="gt_row gt_right">5.084229e-06</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">YearsAtCompany</td>
      <td class="gt_row gt_right">2.563021e-04</td>
    </tr>
  </tbody>
  
  
</table></div>
<pre class="r"><code>df1_ttest</code></pre>
<pre><code>##               Variable T.Test.pvalue
## 1        MonthlyIncome  2.412488e-07
## 2    TotalWorkingYears  6.595682e-07
## 3   YearsInCurrentRole  1.522152e-06
## 4 YearsWithCurrManager  5.084229e-06
## 5       YearsAtCompany  2.563021e-04</code></pre>
</div>
<div id="showing-off-the-most-significant-continious-varables." class="section level2">
<h2>showing off the most significant continious varables.</h2>
<pre class="r"><code>#these varables appear to be significant
mi_plot &lt;-data %&gt;% ggplot(aes(MonthlyIncome))+
  geom_density(aes(fill=Attrition))+
  labs(title=&quot;Monthly Income vs Attrition&quot;)+
  xlab(&quot;Monthly Income&quot;)

twy_plot &lt;-data %&gt;% ggplot(aes(TotalWorkingYears))+
  geom_density(aes(fill=Attrition))+
  labs(title=&quot;Total Working Years vs Attrition&quot;)+
  xlab(&quot;Total Working Years&quot;)

yac_plot &lt;- data %&gt;% ggplot(aes(YearsAtCompany))+
  geom_density(aes(fill=Attrition))+
  labs(title=&quot;Years At the Company vs Attrition&quot;)+
  xlab(&quot;Years at the Company&quot;)

yicr_plot &lt;- data %&gt;% ggplot(aes(YearsInCurrentRole))+
  geom_density(aes(fill=Attrition))+
  labs(title=&quot;Years In Current Role vs Attrition&quot;)+
  xlab(&quot;Years in Current Role&quot;)

ywcm_plot &lt;- data %&gt;% ggplot(aes(YearsWithCurrManager))+
  geom_density(aes(fill=Attrition))+
  labs(title=&quot;Years With Current Manager vs Attrition&quot;)+
  xlab(&quot;Years with Current Manager&quot;)

grid.arrange(mi_plot,twy_plot,yac_plot,yicr_plot,ywcm_plot)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># show both density and box charts</code></pre>
<pre class="r"><code># show the same data as above but in boxplot
mi_plot_box &lt;-data %&gt;% ggplot(aes(MonthlyIncome))+
  geom_boxplot(aes(fill=Attrition))+
  labs(title=&quot;Monthly Income vs Attrition&quot;)+
  xlab(&quot;Monthly Income&quot;)

twy_plot_box &lt;-data %&gt;% ggplot(aes(TotalWorkingYears))+
  geom_boxplot(aes(fill=Attrition))+
  labs(title=&quot;Total Working Years vs Attrition&quot;)+
  xlab(&quot;Total Working Years&quot;)

yac_plot_box &lt;- data %&gt;% ggplot(aes(YearsAtCompany))+
  geom_boxplot(aes(fill=Attrition))+
  labs(title=&quot;Years At the Company vs Attrition&quot;)+
  xlab(&quot;Years at the COmpany&quot;)

yicr_plot_box &lt;- data %&gt;% ggplot(aes(YearsInCurrentRole))+
  geom_boxplot(aes(fill=Attrition))+
  labs(title=&quot;Years In Current Role vs Attrition&quot;)+
  xlab(&quot;Years in Current Role&quot;)

ywcm_plot_box &lt;- data %&gt;% ggplot(aes(YearsWithCurrManager))+
  geom_boxplot(aes(fill=Attrition))+
  labs(title=&quot;Years With Current Manager vs Attrition&quot;)+
  xlab(&quot;Years with Current Manager&quot;)

grid.arrange(mi_plot_box,twy_plot_box,yac_plot_box,yicr_plot_box,ywcm_plot_box)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="wrangling-categorical-varables" class="section level2">
<h2>wrangling categorical varables</h2>
</div>
<div id="calculating-the-proportion" class="section level2">
<h2>calculating the proportion</h2>
</div>
<div id="varables-with-little-relationship" class="section level2">
<h2>varables with little relationship</h2>
<pre class="r"><code>#data %&gt;% group_by(PerformanceRating) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(RelationshipSatisfaction) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(Education) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(EducationField) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(Gender) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(BusinessTravel) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(Department) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(WorkLifeBalance) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)
#data %&gt;% group_by(JobSatisfaction) %&gt;% count(Attrition) %&gt;% mutate(sum=sum(n)) %&gt;% mutate(proportion=n/sum*100) %&gt;% filter(Attrition==&quot;Yes&quot;)</code></pre>
</div>
<div id="categorical-varables-that-show-a-relatinship" class="section level2">
<h2>Categorical varables that show a relatinship</h2>
<pre class="r"><code>data %&gt;% group_by(JobLevel) %&gt;% 
  count(Attrition) %&gt;% 
  mutate(sum=sum(n)) %&gt;% 
  mutate(proportion=n/sum*100) %&gt;% 
  filter(Attrition==&quot;Yes&quot;)</code></pre>
<pre><code>## # A tibble: 5 x 5
## # Groups:   JobLevel [5]
##   JobLevel Attrition     n   sum proportion
##   &lt;fct&gt;    &lt;chr&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 1        Yes          86   329      26.1 
## 2 2        Yes          30   312       9.62
## 3 3        Yes          17   132      12.9 
## 4 4        Yes           3    60       5   
## 5 5        Yes           4    37      10.8</code></pre>
<pre class="r"><code>data %&gt;% group_by(OverTime) %&gt;% 
  count(Attrition) %&gt;% 
  mutate(sum=sum(n)) %&gt;% 
  mutate(proportion=n/sum*100) %&gt;% 
  filter(Attrition==&quot;Yes&quot;)</code></pre>
<pre><code>## # A tibble: 2 x 5
## # Groups:   OverTime [2]
##   OverTime Attrition     n   sum proportion
##   &lt;chr&gt;    &lt;chr&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 No       Yes          60   618       9.71
## 2 Yes      Yes          80   252      31.7</code></pre>
<pre class="r"><code>data %&gt;% group_by(JobInvolvement) %&gt;% 
  count(Attrition) %&gt;% 
  mutate(sum=sum(n)) %&gt;% 
  mutate(proportion=n/sum*100) %&gt;% 
  filter(Attrition==&quot;Yes&quot;)</code></pre>
<pre><code>## # A tibble: 4 x 5
## # Groups:   JobInvolvement [4]
##   JobInvolvement Attrition     n   sum proportion
##   &lt;fct&gt;          &lt;chr&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 1              Yes          22    47      46.8 
## 2 2              Yes          44   228      19.3 
## 3 3              Yes          67   514      13.0 
## 4 4              Yes           7    81       8.64</code></pre>
<pre class="r"><code>data %&gt;% group_by(JobRole) %&gt;% 
  count(Attrition) %&gt;% 
  mutate(sum=sum(n)) %&gt;% 
  mutate(proportion=n/sum*100) %&gt;% 
  filter(Attrition==&quot;Yes&quot;)</code></pre>
<pre><code>## # A tibble: 9 x 5
## # Groups:   JobRole [9]
##   JobRole                   Attrition     n   sum proportion
##   &lt;chr&gt;                     &lt;chr&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 Healthcare Representative Yes           8    76      10.5 
## 2 Human Resources           Yes           6    27      22.2 
## 3 Laboratory Technician     Yes          30   153      19.6 
## 4 Manager                   Yes           4    51       7.84
## 5 Manufacturing Director    Yes           2    87       2.30
## 6 Research Director         Yes           1    51       1.96
## 7 Research Scientist        Yes          32   172      18.6 
## 8 Sales Executive           Yes          33   200      16.5 
## 9 Sales Representative      Yes          24    53      45.3</code></pre>
<pre class="r"><code>data %&gt;% group_by(MaritalStatus) %&gt;% 
  count(Attrition) %&gt;% 
  mutate(sum=sum(n)) %&gt;% 
  mutate(proportion=n/sum*100) %&gt;% 
  filter(Attrition==&quot;Yes&quot;)</code></pre>
<pre><code>## # A tibble: 3 x 5
## # Groups:   MaritalStatus [3]
##   MaritalStatus Attrition     n   sum proportion
##   &lt;chr&gt;         &lt;chr&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 Divorced      Yes          12   191       6.28
## 2 Married       Yes          58   410      14.1 
## 3 Single        Yes          70   269      26.0</code></pre>
</div>
<div id="plotting-the-categorical-varables" class="section level2">
<h2>Plotting the Categorical varables</h2>
<pre class="r"><code>library(patchwork)

JL_chi &lt;- chisq.test(data$JobLevel, data$Attrition)
O_chi &lt;- chisq.test(data$OverTime, data$Attrition)
JI_chi &lt;- chisq.test(data$JobInvolvement, data$Attrition)
JR_chi &lt;- chisq.test(data$JobRole, data$Attrition)</code></pre>
<pre><code>## Warning in chisq.test(data$JobRole, data$Attrition): Chi-squared approximation may be incorrect</code></pre>
<pre class="r"><code>MS_chi &lt;- chisq.test(data$MaritalStatus, data$Attrition)

cat_var = c(&quot;JobLevel&quot;, &quot;OverTime&quot;, &quot;JobInvolvement&quot;, &quot;JobRole&quot;, &quot;MaritalStatus&quot;)
chi_p = c(JL_chi$p.value, O_chi$p.value, JI_chi$p.value, JR_chi$p.value, MS_chi$p.value)
df_chitest = data.frame(Variable=cat_var, Chisq.pvalue=chi_p)

JL_plot &lt;- data %&gt;% ggplot(aes(JobLevel))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;JobLevel vs Attrition&quot;)+coord_flip()
O_plot &lt;- data %&gt;% ggplot(aes(OverTime))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;Overtime vs Attrition&quot;)+coord_flip()
JI_plot &lt;- data %&gt;% ggplot(aes(JobInvolvement))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;JobInvolvement vs Attrition&quot;)+coord_flip()
JS_plot &lt;- data %&gt;% ggplot(aes(JobSatisfaction))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;JobSatisfaction vs Attrition&quot;)+coord_flip()
JR_plot &lt;-data %&gt;% ggplot(aes(JobRole))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;JobRole vs Attrition&quot;)+ coord_flip()+ theme(axis.text.x = element_text(angle = 35))+ theme(axis.text.y = element_text(vjust = .5,hjust = 1))
MS_plot &lt;- data %&gt;% ggplot(aes(MaritalStatus))+geom_bar(aes(fill=Attrition)) + labs(title=&quot;MaritalStatus vs Attrition&quot;)+coord_flip()

#Chi square test to determine correlation
JL_chi &lt;- chisq.test(data$JobLevel, data$Attrition)
O_chi &lt;- chisq.test(data$OverTime, data$Attrition)
JI_chi &lt;- chisq.test(data$JobInvolvement, data$Attrition)
JR_chi &lt;- chisq.test(data$JobRole, data$Attrition)</code></pre>
<pre><code>## Warning in chisq.test(data$JobRole, data$Attrition): Chi-squared approximation may be incorrect</code></pre>
<pre class="r"><code>MS_chi &lt;- chisq.test(data$MaritalStatus, data$Attrition)

cat_var = c(&quot;JobLevel&quot;, &quot;OverTime&quot;, &quot;JobInvolvement&quot;, &quot;JobRole&quot;, &quot;MaritalStatus&quot;)
chi_p = c(JL_chi$p.value, O_chi$p.value, JI_chi$p.value, JR_chi$p.value, MS_chi$p.value)
df_chitest = data.frame(Variable=cat_var, Chisq.pvalue=chi_p)

JR_plot+(JL_plot+ O_plot)+ (JI_plot+MS_plot)+ plot_layout(ncol = 1)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>#grid.arrange(JL_plot, O_plot, JI_plot, JR_plot, MS_plot,
#  widths = c(1,1,1),c(1,1,1),layout_matrix = rbind(c(1, 2, 3))),c(4,5,5)))
df_chitest</code></pre>
<pre><code>##         Variable Chisq.pvalue
## 1       JobLevel 2.084703e-08
## 2       OverTime 2.332981e-15
## 3 JobInvolvement 5.211041e-09
## 4        JobRole 3.646836e-10
## 5  MaritalStatus 3.378946e-08</code></pre>
<p>##NaiveBayes variables were:<br />
* OverTime<br />
* JobRole<br />
* JobInvolvement<br />
* MonthlyIncome<br />
* TotalWorkingYears<br />
* YearsInCurrentRole<br />
* JobLevel</p>
<pre class="r"><code># Goal: reach a sensitivity and specificty greater than 60%
# add varables one by one until a desiered result is acheived
set.seed(12)
splitPerc = .75

trainindex = sample(seq(1,dim(data)[1],1), round(splitPerc*dim(data)[1]))

trainIndices = sample(seq(1,dim(data)[1],1),round(splitPerc * dim(data)[1]))
train = data[trainindex,]
test = data[-trainindex,]
#note it is illegal to know about relationship status when interviewing

m = naiveBayes(Attrition~OverTime+JobRole+JobInvolvement+MonthlyIncome+TotalWorkingYears+JobLevel,data=train)
table(predict(m, newdata=test),test$Attrition)</code></pre>
<pre><code>##      
##        No Yes
##   No  176  11
##   Yes  13  18</code></pre>
<pre class="r"><code>CM = confusionMatrix(table(predict(m, newdata=test),test$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  176  11
##   Yes  13  18
##                                           
##                Accuracy : 0.8899          
##                  95% CI : (0.8406, 0.9282)
##     No Information Rate : 0.867           
##     P-Value [Acc &gt; NIR] : 0.1859          
##                                           
##                   Kappa : 0.5363          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.8383          
##                                           
##             Sensitivity : 0.9312          
##             Specificity : 0.6207          
##          Pos Pred Value : 0.9412          
##          Neg Pred Value : 0.5806          
##              Prevalence : 0.8670          
##          Detection Rate : 0.8073          
##    Detection Prevalence : 0.8578          
##       Balanced Accuracy : 0.7760          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
<pre class="r"><code>#grid.arrange(O_plot, JR_plot,JI_plot, mi_plot, twy_plot,yicr_plot,JL_plot)

comp_NB = naiveBayes(Attrition~OverTime+MonthlyIncome+JobRole+TotalWorkingYears+JobInvolvement+JobLevel,data=data)

pred_att = data.frame(Attrition =predict(comp_NB, newdata=Comp_attr))
att_comp &lt;-bind_cols(Comp_attr,pred_att)

JR_plot+ (O_plot +JI_plot)+ plot_layout(ncol = 1)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>(mi_plot_box+ twy_plot_box)+(JL_plot)+ plot_layout(ncol = 1)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>#this meets out goal but we could do better. It is dependent on the seed
#summary(att_comp)


#write.csv(select(att_comp,ID,Attrition),file=&quot;Case2Predictions_Scott_Attrition.csv&quot;)</code></pre>
</div>
<div id="trying-a-better-model-could-be-overfitting-however." class="section level2">
<h2>trying a “better model” could be overfitting however.</h2>
<pre class="r"><code>#Variables such as TotalWorkingYears, YearsAtCompany, YearsInCurrentRole, YearsSinceLastPromotion and YearsWithCurrentManager are highly corelated to each other.
# removed from the model due to colinearity. Left total working years
set.seed(12)
splitPerc = .75
head(data)</code></pre>
<pre><code>##   ID Age Attrition    BusinessTravel DailyRate             Department DistanceFromHome Education   EducationField
## 1  1  32        No     Travel_Rarely       117                  Sales               13         4    Life Sciences
## 2  2  40        No     Travel_Rarely      1308 Research &amp; Development               14         3          Medical
## 3  3  35        No Travel_Frequently       200 Research &amp; Development               18         2    Life Sciences
## 4  4  32        No     Travel_Rarely       801                  Sales                1         4        Marketing
## 5  5  24        No Travel_Frequently       567 Research &amp; Development                2         1 Technical Degree
## 6  6  27        No Travel_Frequently       294 Research &amp; Development               10         2    Life Sciences
##   EmployeeCount EmployeeNumber EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1             1            859                       2   Male         73              3        2
## 2             1           1128                       3   Male         44              2        5
## 3             1           1412                       3   Male         60              3        3
## 4             1           2016                       3 Female         48              3        3
## 5             1           1646                       1 Female         32              3        1
## 6             1            733                       4   Male         32              3        3
##                  JobRole JobSatisfaction MaritalStatus MonthlyIncome MonthlyRate NumCompaniesWorked Over18 OverTime
## 1        Sales Executive               4      Divorced          4403        9250                  2      Y       No
## 2      Research Director               3        Single         19626       17544                  1      Y       No
## 3 Manufacturing Director               4        Single          9362       19944                  2      Y       No
## 4        Sales Executive               4       Married         10422       24032                  1      Y       No
## 5     Research Scientist               4        Single          3760       17218                  1      Y      Yes
## 6 Manufacturing Director               1      Divorced          8793        4809                  1      Y       No
##   PercentSalaryHike PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel TotalWorkingYears
## 1                11                 3                        3            80                1                 8
## 2                14                 3                        1            80                0                21
## 3                11                 3                        3            80                0                10
## 4                19                 3                        3            80                2                14
## 5                13                 3                        3            80                0                 6
## 6                21                 4                        3            80                2                 9
##   TrainingTimesLastYear WorkLifeBalance YearsAtCompany YearsInCurrentRole YearsSinceLastPromotion
## 1                     3               2              5                  2                       0
## 2                     2               4             20                  7                       4
## 3                     2               3              2                  2                       2
## 4                     3               3             14                 10                       5
## 5                     2               3              6                  3                       1
## 6                     4               2              9                  7                       1
##   YearsWithCurrManager
## 1                    3
## 2                    9
## 3                    2
## 4                    7
## 5                    3
## 6                    7</code></pre>
<pre class="r"><code>trainindex = sample(seq(1,dim(data)[1],1), round(splitPerc*dim(data)[1]))

trainIndices = sample(seq(1,dim(data)[1],1),round(splitPerc * dim(data)[1]))
train = data[trainindex,]
test = data[-trainindex,]
#note it is illegal to know about relationship status when interviewing
m = naiveBayes(Attrition~BusinessTravel+DistanceFromHome+EnvironmentSatisfaction+JobInvolvement+JobSatisfaction+MaritalStatus+NumCompaniesWorked+OverTime+TotalWorkingYears+RelationshipSatisfaction+MonthlyIncome+JobRole+YearsInCurrentRole+JobLevel,data=train)
table(predict(m, newdata=test),test$Attrition)</code></pre>
<pre><code>##      
##        No Yes
##   No  168  10
##   Yes  21  19</code></pre>
<pre class="r"><code>CM = confusionMatrix(table(predict(m, newdata=test),test$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  168  10
##   Yes  21  19
##                                           
##                Accuracy : 0.8578          
##                  95% CI : (0.8043, 0.9013)
##     No Information Rate : 0.867           
##     P-Value [Acc &gt; NIR] : 0.69734         
##                                           
##                   Kappa : 0.4688          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.07249         
##                                           
##             Sensitivity : 0.8889          
##             Specificity : 0.6552          
##          Pos Pred Value : 0.9438          
##          Neg Pred Value : 0.4750          
##              Prevalence : 0.8670          
##          Detection Rate : 0.7706          
##    Detection Prevalence : 0.8165          
##       Balanced Accuracy : 0.7720          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
<pre class="r"><code>#grid.arrange(O_plot, JR_plot,JI_plot, mi_plot, twy_plot,yicr_plot,JL_plot)

comp_NB = naiveBayes(Attrition~BusinessTravel+DistanceFromHome+EnvironmentSatisfaction+JobInvolvement+JobSatisfaction+MaritalStatus+NumCompaniesWorked+OverTime+TotalWorkingYears+RelationshipSatisfaction+MonthlyIncome+JobRole+YearsInCurrentRole+JobLevel,data=data)

pred_att = data.frame(Attrition =predict(comp_NB, newdata=Comp_attr))
att_comp &lt;-bind_cols(Comp_attr,pred_att)</code></pre>
</div>
<div id="salary-eda" class="section level2">
<h2>Salary EDA</h2>
<p>Categorical Variables Vs MonthlyIncome * JobLevel<br />
* Education<br />
* JobRole<br />
* EducationField</p>
<pre class="r"><code>#Ordinal variable EDA
#data %&gt;% select(Education, EnvironmentSatisfaction, JobInvolvement, JobSatisfaction, PerformanceRating, WorkLifeBalance, JobLevel, RelationshipSatisfaction, MonthlyIncome) %&gt;% ggpairs(upper = list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;), lower=list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;))
# Correlation to JobLevel, maybe Education

JLS_plot &lt;- data %&gt;% ggplot(aes(JobLevel, MonthlyIncome))+geom_boxplot()+labs(title=&quot;Job Level vs MI&quot;)

ES_plot &lt;- data %&gt;% ggplot(aes(Education, MonthlyIncome))+geom_boxplot()+labs(title=&quot;Education vs MI&quot;)

#Nominal variable EDA
#data %&gt;% select(Attrition, BusinessTravel, Department, EducationField, Gender, JobRole, MaritalStatus, OverTime, MonthlyIncome) %&gt;% ggpairs(upper = list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;), lower=list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;))
# JobRole has interesting differences.  Maybe EducationField

JRS_plot &lt;- data %&gt;% ggplot(aes(JobRole,MonthlyIncome))+geom_boxplot()+labs(title=&quot;Job Role vs MI&quot;)+coord_flip()

EFS_plot &lt;- data %&gt;% ggplot(aes(EducationField,MonthlyIncome))+geom_boxplot()+labs(title=&quot;Education Field vs MI&quot;)+coord_flip()

JLS_plot+EFS_plot+ ES_plot + JRS_plot+  plot_layout(ncol = 2)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>#grid.arrange(JLS_plot, ES_plot, JRS_plot, EFS_plot)</code></pre>
</div>
<div id="continious-varables" class="section level2">
<h2>Continious Varables</h2>
<ul>
<li>Age<br />
</li>
<li>TotalWorkingYears<br />
</li>
<li>Years at Company</li>
</ul>
<pre class="r"><code># there is a possibility that total years worked and years at company could be colinear and we do not want that

#Continous variable EDA
#data %&gt;% select(Age,DailyRate, DistanceFromHome, HourlyRate, MonthlyRate, NumCompaniesWorked, PercentSalaryHike, MonthlyIncome) %&gt;% ggpairs(upper = list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;), lower=list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;))
# Age has a positive correlation

AgS_plot &lt;- data %&gt;% ggplot(aes(Age,MonthlyIncome))+geom_point()+geom_smooth(method=&quot;lm&quot;)+labs(title = &quot;Age vs Monthly Income&quot;)

#data %&gt;% select(StockOptionLevel, TotalWorkingYears, TrainingTimesLastYear, YearsSinceLastPromotion, YearsInCurrentRole, YearsWithCurrManager, YearsAtCompany, MonthlyIncome) %&gt;% ggpairs(upper = list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;), lower=list(continuous=&quot;smooth&quot;, combo=&quot;box&quot;, discrete = &quot;facetbar&quot;))
#TotalWorking Years and YearsatCompany have a strong correlation
#Years SinceLastPromotion, InCurrentRole and WithCurrManager have weak positive correlation

TWYS_plot &lt;- data %&gt;% ggplot(aes(TotalWorkingYears,MonthlyIncome))+geom_point()+geom_smooth(method=&quot;lm&quot;)+labs(title = &quot;TotalWorkingYears vs Monthly Income&quot;)

YaCS_plot &lt;- data %&gt;% ggplot(aes(YearsAtCompany,MonthlyIncome))+geom_point()+geom_smooth(method=&quot;lm&quot;)+labs(title = &quot;YearsAtCompany vs Monthly Income&quot;)

grid.arrange(AgS_plot,TWYS_plot, YaCS_plot)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>corr_data &lt;- data %&gt;% select(Age, TotalWorkingYears, YearsAtCompany, YearsSinceLastPromotion, YearsInCurrentRole, YearsWithCurrManager, MonthlyIncome)

corr &lt;- round(cor(corr_data),1)

ggcorrplot(corr, hc.order = TRUE, 
           type = &quot;lower&quot;, 
           lab = TRUE, 
           lab_size = 3, 
           method=&quot;circle&quot;, 
           colors = c(&quot;red&quot;, &quot;white&quot;, &quot;springgreen3&quot;), 
           title=&quot;Correlogram of Continuous Variables&quot;, 
           ggtheme=theme_bw)</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="lm-salary" class="section level2">
<h2>LM Salary</h2>
<pre class="r"><code>Salary_train &lt;- data %&gt;% select(MonthlyIncome, TotalWorkingYears, JobLevel)

fit &lt;- lm(MonthlyIncome~TotalWorkingYears+JobLevel, data=Salary_train)

summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ TotalWorkingYears + JobLevel, data = Salary_train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4957.9  -657.8  -134.6   618.2  4525.8 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        2544.901     89.085  28.567  &lt; 2e-16 ***
## TotalWorkingYears    33.442      9.426   3.548 0.000409 ***
## JobLevel2          2652.205    107.666  24.634  &lt; 2e-16 ***
## JobLevel3          6820.371    152.732  44.656  &lt; 2e-16 ***
## JobLevel4         11858.212    254.564  46.582  &lt; 2e-16 ***
## JobLevel5         15800.546    289.997  54.485  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1256 on 864 degrees of freedom
## Multiple R-squared:  0.9258, Adjusted R-squared:  0.9254 
## F-statistic:  2157 on 5 and 864 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#confint(fit)

train(MonthlyIncome~TotalWorkingYears+JobLevel, method=&quot;lm&quot;,data=Salary_train, trControl = trainControl(method = &quot;LOOCV&quot;))</code></pre>
<pre><code>## Linear Regression 
## 
## 870 samples
##   2 predictor
## 
## No pre-processing
## Resampling: Leave-One-Out Cross-Validation 
## Summary of sample sizes: 869, 869, 869, 869, 869, 869, ... 
## Resampling results:
## 
##   RMSE      Rsquared   MAE     
##   1261.666  0.9246115  915.7436
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<pre class="r"><code>grid.arrange(TWYS_plot, JLS_plot)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="CaseStudy2DDS_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>pred_sal = data.frame(MonthlyIncome = predict(fit, newdata = Comp_sal))
sal_comp &lt;-bind_cols(Comp_sal, pred_sal)

#summary(sal_comp)

#write.csv(select(sal_comp,ID,MonthlyIncome), file=&quot;Case2Predictions_Scott_Salary.csv&quot;)</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
